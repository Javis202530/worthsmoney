<!DOCTYPE html>
<!-- LOGIN -->
<div id="loginBox" class="hidden">
<input id="loginId" placeholder="Email or Phone" />
<input id="loginPass" type="password" placeholder="Password" />
<button onclick="login()">Login</button>
</div>


<div class="switch">
<span id="switchText">Already have an account?</span>
<a href="#" onclick="toggle()">Login</a>
</div>
</div>


<script>
let isLogin = false;


function toggle() {
isLogin = !isLogin;
document.getElementById('signupBox').classList.toggle('hidden');
document.getElementById('loginBox').classList.toggle('hidden');
document.getElementById('title').innerText = isLogin ? 'Login' : 'Create Account';
document.getElementById('switchText').innerText = isLogin ? 'No account?' : 'Already have an account?';
}


async function hashPassword(password) {
const msgUint8 = new TextEncoder().encode(password);
const hashBuffer = await crypto.subtle.digest('SHA-256', msgUint8);
return Array.from(new Uint8Array(hashBuffer))
.map(b => b.toString(16).padStart(2, '0')).join('');
}


async function signup() {
const name = nameInput.value;
const email = email.value;
const phone = phone.value;
const pass = password.value;


if (!name || !email || !phone || !pass) {
alert('Fill all fields');
return;
}


const users = JSON.parse(localStorage.getItem('users')) || [];
if (users.find(u => u.email === email || u.phone === phone)) {
alert('User already exists');
return;
}


const hashed = await hashPassword(pass);


users.push({
id: Date.now(),
name,
email,
phone,
password: hashed,
verified: false
});


localStorage.setItem('users', JSON.stringify(users));
alert('Account created! Verification email sent (simulated).');
}


async function login() {
const id = loginId.value;
const pass = loginPass.value;
const users = JSON.parse(localStorage.getItem('users')) || [];


const hashed = await hashPassword(pass);
const user = users.find(u => (u.email === id || u.phone === id) && u.password === hashed);


if (!user) {
alert('Invalid credentials');
return;
}


if (!user.verified) {
alert('Please verify your email before login');
return;
}


localStorage.setItem('user', JSON.stringify(user));
window.location.href = 'dashboard.html';
}
</script>


</body>
</html>
